# Test Fixtures for GlickoStrategy

This directory contains JSON fixtures captured from real GlickoStrategy
evaluations. These fixtures provide deterministic test data for unit tests.

## Fixture Files

- `glicko-scoring-gen1.json` - Evaluation data from generation 1
- `glicko-scoring-gen3.json` - Evaluation data from generation 3 (shows
  progression)

## Regenerating Fixtures

The fixtures are generated by skipped tests in `generator.test.ts`. To
regenerate:

### 1. Edit the generator test

Open `generator.test.ts` and remove `.skip` from the test you want to run:

```ts
// Before:
test.skip("generate fixture: 1 generation evaluation", async () => {});

// After:
test("generate fixture: 1 generation evaluation", async () => {});
```

### 2. Run the generator

```bash
# From package directory
cd packages/tournament-strategy
yarn test test/fixtures/generator.test.ts

# Or from repo root
yarn workspace @heygrady/tournament-strategy test test/fixtures/generator.test.ts
```

### 3. Verify and commit

```bash
# Check the generated file
cat test/fixtures/glicko-scoring-gen1.json

# Add .skip back to the test
# Then commit the fixture
git add test/fixtures/*.json
git commit -m "chore(tournament-strategy): regenerate test fixtures"
```

## Fixture Structure

See `types.ts` for the complete type definitions. Each fixture contains:

- **timestamp**: When it was generated
- **generation**: Which generation was captured
- **populationSize**: How many genomes were evaluated
- **config**: All strategy options used
- **results**: Array of evaluation results for each genome
  - Components (seedScore, environmentScore, glickoScore, conservativeScore,
    innovationScore)
  - Raw data (glickoRating, glickoRd, etc.)
  - Final fitness value
- **heroes**: Hero state captured

## Using Fixtures in Tests

```typescript
import gen1Fixture from "../fixtures/glicko-scoring-gen1.json";

test("component calculation", () => {
  const result = gen1Fixture.results[0];

  // Test conservative score calculation
  const expected = result.rawData.glickoRating - 2 * result.rawData.glickoRd;
  // ...
});
```

## Notes

- Fixtures are **deterministic** - regenerating should produce similar values
- Fixtures are **version-controlled** - commit them after regeneration
- Fixtures are **read-only** in tests - don't modify them directly
- Keep fixtures **small** - use 10-20 genomes, not 100+
